# 开发环境说明

## 一、概述

本系统为一个智慧物流车队与配送管理系统，采用前后端一体化 Web 架构，后端基于 Flask 框架，数据库使用 Microsoft SQL Server，通过触发器，存储过程和视图实现核心业务规则与统计分析，并建立索引进行优化。

系统主要包含以下模块：

- 车辆与司机管理

- 运单管理（新建、分配、编辑、状态流转）

- 异常管理（录入、处理、预警）

- 存储过程计算车队月报与司机绩效

- 视图查询异常告警和异常预警

- 触发器实现车辆载重校验、车辆\运单状态自动流转和审计日志录入等功能

- 前端页面展示与交互

- 后端接口与业务校验



## 二、硬件与操作系统环境

| 项目   | 配置                      |
| ---- | ----------------------- |
| 操作系统 | Windows 10 / Windows 11 |
| CPU  | x64 架构处理器               |
| 内存   | ≥ 8 GB                  |
| 磁盘   | ≥ 10 GB 可用空间            |
| 网络   | 本地开发环境（localhost）       |

## 三、软件环境配置

### 1.编程语言与运行环境

| 项目     | 版本           |
| ------ | ------------ |
| Python | 3.9 / 3.10   |
| 虚拟环境管理 | Conda / venv |
| 编码格式   | UTF-8        |

### 2.后端框架与核心依赖

| 组件          | 说明               |
| ----------- | ---------------- |
| Flask       | Web 后端框架         |
| Jinja2      | 模板引擎             |
| pymssql     | SQL Server 数据库驱动 |
| Werkzeug    | 路由与请求处理          |
| Bootstrap 5 | 前端样式框架           |

示例依赖（requirements.txt）：

```txt
Flask==3.0.3
pymssql==2.3.2
python-dotenv==1.0.1
```

### 3.数据库环境

| 项目     | 配置                   |
| ------ | -------------------- |
| 数据库类型  | Microsoft SQL Server |
| 数据库名称  | FleetDB              |
| 数据访问方式 | pymssql              |
| 字符集    | NVARCHAR（支持中文）       |

数据库包含以下核心对象：

- 表：配送中心表`centers`、车队表`fleets`、车辆表`vehicles`、司机表`drivers`、主管表`supervisors`、运单表`orders`、异常事件表`exception_events`、审计日志表`history_log`

- 视图：
  
  - 近7天异常告警视图：`vw_weekly_exception_alert`
  
  - 近30天异常司机/车辆预警：`vw_abnormal_driver_vehicle_alert`

- 存储过程：
  
  - 车队月度报表：`sp_fleet_monthly_report`
  - 司机绩效统计：`sp_driver_performance`

- 触发器：
  
  - 车辆载重校验触发器：`trg_check_vehicle_capacity`
  
  - 车辆状态自动流转触发器：`trg_vehicle_status_auto_update`
  
  - 异常处理触发器
  
  - 审计日志触发器

## 四、系统架构说明

```
浏览器
 │
 ▼
Flask Web Server
 │
 ├── 业务逻辑层（权限 / 状态校验）
 ├── 数据访问层（db.py）
 │
 ▼
SQL Server
 ├── 表
 ├── 视图
 ├── 触发器
 └── 存储过程
```

## 五、运行与启动方式

### 1、创建数据库

依次执行以下数据库文件来创建数据库并初始化数据
```sql
init_table.sql
indexes.sql
procedures.sql
views.sql
triggers.sql
init_data.sql
```

### 2、运行
命令行执行命令
```
pip install -r requirements.txt
flask run
```
然后访问网址
```
http://127.0.0.1:5000
```

## 六、测试环境与测试方法

### 1、前端页面测试

浏览器手动操作：
- 验证页面流程是否符合业务逻辑
- 验证前端校验是否正确
- 验证提示信息是否正确显示

### 2、数据库级测试

在SSMS中运行sql测试脚本：
- 验证存储器是否正确
- 验证视图与存储过程返回结果
- 验证索引所提升的效率