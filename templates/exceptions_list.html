{% extends "base.html" %}
{% block content %}

<div class="d-flex justify-content-between align-items-center">
  <h4 class="mb-0">异常列表</h4>

  {% if user.role == 'supervisor' %}
    <a class="btn btn-sm btn-primary"
       href="{{ url_for('exceptions_new') }}">
      录入异常
    </a>
  {% endif %}
</div>

<table class="table table-striped mt-3">
  <thead>
    <tr>
      <th>ID</th>
      <th>发生时间</th>
      <th>类型</th>
      <th>状态</th>
      <th>罚款</th>
      <th>车牌</th>
      <th>司机</th>
      <th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for e in exceptions %}
      <tr>
        <td>{{ e.event_id }}</td>
        <td>{{ e.occurred_time }}</td>
        <td>{{ e.exception_type }}</td>
        <td>{{ e.status }}</td>
        <td>{{ e.fine_amount }}</td>
        <td>{{ e.license_plate_number }}</td>
        <td>{{ e.driver_name }}</td>
        <td>
          <a href="{{ url_for('exception_detail', event_id=e.event_id) }}">详情</a>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
