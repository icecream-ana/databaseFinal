{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center">
  <h4>司机管理（车队 {{ user.fleet_id }}）</h4>
  <a class="btn btn-sm btn-primary" href="{{ url_for('master_driver_new') }}">新增司机</a>
</div>

<table class="table table-striped mt-2">
  <thead>
    <tr>
      <th>ID</th><th>姓名</th><th>驾照等级</th><th>电话</th><th>操作</th>
    </tr>
  </thead>
  <tbody>
    {% for d in drivers %}
      <tr>
        <td>{{ d.driver_id }}</td>
        <td>{{ d.name }}</td>
        <td>{{ d.license_level }}</td>
        <td>{{ d.phone }}</td>
        <td>
          <a href="{{ url_for('master_driver_edit', driver_id=d.driver_id) }}">编辑</a>

          <form method="post"
            action="{{ url_for('master_driver_delete_post', driver_id=d.driver_id) }}"
            style="display:inline;"
            onsubmit="return confirm('确认删除该司机吗？删除后不可恢复。');">
            <button type="submit" class="btn btn-link p-0 ms-2">删除</button>
          </form>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<div class="text-muted small">
  说明：更新司机姓名/电话/驾照等级时，数据库触发器会写入 history_log 审计记录。
</div>
{% endblock %}
